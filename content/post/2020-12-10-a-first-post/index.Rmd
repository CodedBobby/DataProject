---
title: Volcano
author: ~
date: '2020-12-13'
slug: A-first-post
categories: []
tags: []
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy = TRUE)
```

Using the volcano data from tinytuesday I will investigate volcanic eruptions and the affect they have on the environment. I will use the volcano, eruptions and sulfur datasets in order to explore this. The volcano dataset contains the variables volcano_number and volcano_name, which can be used to identify the volcanoes, latitude and longitude, doubles which can show where the volcanoes are and primary_volcano_type, a factor with 26 levels which shows what type of volcano it is.

```{r, message=FALSE, include=FALSE}
library(here)
library(ggplot2)
library(tidyverse)
library(readxl)
library(dplyr)
```

```{r}
dat1<-read.csv(here::here("content","post","2020-12-10-a-first-post","data","volcano.csv"))
dat2<-read.csv(here::here("content","post","2020-12-10-a-first-post","data","eruptions.csv"))
dat3<-read.csv(here::here("content","post","2020-12-10-a-first-post","data","events.csv"))
dat4<-read.csv(here::here("content","post","2020-12-10-a-first-post","data","sulfur.csv"))
```

# Question 1:
To what extent does a volcano eruption impact the atmosphere? To explore this I will attempt to determine the relation between major volcanic eruptions (defined here as any eruption with a vei of 4 or higher) and spikes in sulfur levels in both Greenland and Antarctica. I will do this by creating a line graph with sulfur concentrations and plotting the major volcanic eruptions as dots on the date they occurred.
```{r, message=FALSE}
filtered <- dat1 %>%
  
  left_join(dat2, by = c("volcano_number","volcano_name","longitude","latitude"))%>%
  
  filter(vei >= 4, start_year >= 500,start_year <= 706)
ggplot()+
  
  geom_line(data=dat4, aes(year, neem, color = "blue"))+
  
  geom_line(data=dat4, aes(year, wdc, color = "red"))+
  
  geom_point(data=filtered, aes(start_year,0))+
  
  scale_color_manual(name="Location of Ice Cores",labels=c("Greenland","Antarctica"),values=c("blue"="blue","red"="red"))+
  
  ylab("Sulfur (ng/g)")+
  
  xlab("Year")+
  
  ggtitle("Year vs Sulfur")
```
Most major volcanic eruptions seem to coincide with a large spike in sulfur concentration in either Greenland or Antarctica. However, not all major volcanic eruptions seem to cause a spike in sulfur levels, which could possibly be because these volcanoes are too far away to affect Greenland and Antarctica. This suggests the impact most volcanoes can have on the atmosphere is limited and significantly decreases as distance increases. However, within their range, volcanoes seem to have a large, although somewhat temporary affect on the atmosphere.

# Question 2:
Are there any areas currently at risk from volcano eruptions?
```{r, message=FALSE}
dat1 %>%
  
  left_join(dat2, by = c("volcano_number","volcano_name","longitude","latitude"))%>%
  
  group_by(volcano_name,volcano_number)%>%
  
  filter(start_year >= 1800, start_year == max(start_year))%>%
  
  select(region,longitude,latitude)%>%
  
  ggplot(aes(longitude,latitude))+
  
  geom_point()+
  
  borders("world")+
  
  coord_quickmap()+
  
  ggtitle("Location of Recently Erupted Volcanoes")
```

# Question 3:
What volcanoes have erupted the most often?
```{r, message=FALSE}
dat1 %>%
  
  left_join(dat2, by = c("volcano_number","volcano_name","longitude","latitude"))%>%
  
  group_by(volcano_number,volcano_name)%>%
  
  summarize(total = n())%>%
  
  ungroup()%>%
  
  slice_max(total, n = 10)
```


# Conclusion:

